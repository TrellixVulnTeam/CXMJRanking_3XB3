<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Analysis</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
     <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous" />

    <style>
        .card-body>div:nth-child(even)> .media:nth-child(odd){
            {#border-bottom: solid 1px #e5e5e5;#}
            background: #f5f5f5;
        }
        .media strong{
            background: #65be95;
            color: #fff;
        }
    </style>

</head>
<body ng-app="myApp" ng-controller="bodyController">

<nav class="navbar fixed-top navbar-light bg-light ">
    <input type="search" class="form-control form-control-sm col-9" value="" />

    <button class="btn btn-sm btn-outline-secondary col-2">-></button>

</nav>
<br />
<br />
<input type="hidden" id="date" value="{{ date }}">

<h5 class="text-center">[[ contentList.name_list ]] <small class="text-muted">[[ contentList.date ]]</small></h5>

<div class="card " ng-repeat="(i, sw) in contentList.common_vector">
    <div class="card-body">
        <h5 class=" text-right"><span>[[ round3(sw.score10) ]]</span><span class="badge badge-secondary">[[i+1]]</span></h5>
        <div ng-repeat="cat_obj in contentList.struct">
        <div class="media" >
            <strong class="mr-0 col-5">[[ cat_obj.cat ]]</strong>
              <div class="media-body col-7">

                  <div><span ng-repeat="w in sw.words[cat_obj.id]"><label class="btn-sm btn-outline-dark">[[ w ]]</label></span></div>
                  <div><label>[[ sw.comments[cat_obj.id] ]]</label></div>
              </div>
        </div>
        <div class="media" ng-repeat="child in cat_obj.child" >
            <strong class="pl-5 col-5">[[ child.cat ]]</strong>
              <div class="media-body col-7">

                  <div><span ng-repeat="w in sw.words[child.id]"><label class="btn-sm btn-outline-dark">[[ w ]]</label></span></div>
                  <div><label>[[ sw.comments[child.id] ]]</label></div>
              </div>
        </div>
    </div>
    </div>
</div>


{#<div ng-repeat="tea in contentList">#}
{#    <h4>Form [[ $index + 1 ]]</h4>#}
{#    <div ng-repeat=" (cat, v) in tea">#}
{#        <h5> [[ cat ]]</h5>#}
{#        <div ng-if='v.length'>#}
{#            <div ng-repeat="p in v">[[ p ]]</div>#}
{#        </div>#}
{#        <div ng-if='!v.length'>#}
{#            <div ng-repeat="(sub, obj) in v">#}
{#                <h6>[[ sub ]]</h6>#}
{#                <div ng-repeat="p in obj">[[ p ]]</div>#}
{#            </div>#}
{#        </div>#}
{#    </div>#}
{#</div>#}

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>


<script src="https://cdn.staticfile.org/angular.js/1.6.3/angular.min.js"></script>

<script>
    var app = angular.module('myApp', []);

    app.config(function($interpolateProvider){
        $interpolateProvider.startSymbol('[[').endSymbol(']]');
    });

    app.controller('bodyController', function($scope, $http) {
        console.log(location.href)
        var date = document.getElementById('date').value
        var url = location.href.split('?')[0] + "/../../service/survey/analysis?date=" + date

        $http({
            method: 'GET',
            url: url

        }).then(function successCallback(response) {
                $scope.contentList = response.data;
                $scope.contentListLength = $scope.contentList.length;
                console.log($scope.contentList)
            }, function errorCallback(response) {
                // 请求失败执行代码
        });
    })
</script>

</body>
</html>