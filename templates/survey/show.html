<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Edit User Form</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Life is not esay</title>
     <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous" />

    <style>
        .card-body>div:nth-child(even)> .media:nth-child(odd){
            {#border-bottom: solid 1px #e5e5e5;#}
            background: #f5f5f5;
        }
        .media strong{
            background: #65be95;
            color: #fff;
        }

    </style>
</head>
<body ng-app="myApp" ng-controller="bodyController">

<nav class="navbar fixed-top navbar-light bg-light ">
    <input type="search" class="form-control form-control-sm col-9" value="" />

    <button class="btn btn-sm btn-outline-secondary col-2">-></button>

</nav>
<input type="hidden" id="user" value="{{ user }}">
<input type="hidden" id="date" value="{{ date }}">
<br />
<br />


<h3 class="text-center">[[ details.user ]] <small class="text-muted">[[ details.date ]]</small></h3>


<div class="card " ng-repeat="(i, sw) in details.survey_word">
    <div class="card-body">
        <h5 class=" text-right"><span>[[ round3(sw.score10) ]]</span><span class="badge badge-secondary">[[i+1]]</span></h5>
        <div ng-repeat="cat_obj in details.struct">
        <div class="media" >
            <strong class="mr-0 col-5">[[ cat_obj.cat ]]</strong>
              <div class="media-body col-7">
    {#            <h4 class="mt-0"></h4>#}
                  <div><span ng-repeat="w in sw.words[cat_obj.id]"><label class="btn-sm btn-outline-dark">[[ w ]]</label></span></div>
                  <div><label>[[ sw.comments[cat_obj.id] ]]</label></div>
              </div>
        </div>
        <div class="media" ng-repeat="child in cat_obj.child" >
            <strong class="pl-5 col-5">[[ child.cat ]]</strong>
              <div class="media-body col-7">
    {#            <h4 class="mt-0"></h4>#}
                  <div><span ng-repeat="w in sw.words[child.id]"><label class="btn-sm btn-outline-dark">[[ w ]]</label></span></div>
                  <div><label>[[ sw.comments[child.id] ]]</label></div>
              </div>
        </div>
    </div>
    </div>
</div>

<ul class="list-unstyled">
  <li>
      <dl class="row">
          <dt class="col-sm-3">fdgfdgfdg</dt>
          <dd class="col-sm-9">A description list is perfect for defining terms.</dd>
        </dl>

        <ul>
          <li>
              <dl class="row">
                  <dt class="col-sm-3">fdgfdgfdg</dt>
                  <dd class="col-sm-9">A description list is perfect for defining terms.</dd>
                </dl>
          </li>
        </ul>
  </li>
  <li>Consectetur adipiscing elit</li>

    <ul>
      <li>Phasellus iaculis neque</li>
      <li>Purus sodales ultricies</li>
      <li>Vestibulum laoreet porttitor sem</li>
      <li>Ac tristique libero volutpat at</li>
    </ul>
  </li>
  <li>Faucibus porta lacus fringilla vel</li>
  <li>Aenean sit amet erat nunc</li>
</ul>


<div ng-repeat="cat_obj in details.struct">
    <dl class="row">
      <dt class="col-sm-3">[[ cat_obj.cat ]]</dt>
      <dd class="col-sm-9"><label>item</label>.</dd>
    </dl>
    <dl class="row ml-3" ng-repeat="child in cat_obj.child">
        <dt class="col-sm-3">[[ child.cat ]]</dt>
         <dd class="col-sm-9"><label>item</label> </dd>
    </dl>
</div>


<table class="table table-striped table-sm">
  <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">Category</th>
      <th scope="col">Feature</th>
      <th scope="col">Comments</th>
    </tr>
  </thead>
  <tbody>


    <tr ng-repeat="(i, cat_obj) in details.struct" >
          <th scope="row"> [[ i ]]</th>
          <td>[[ cat_obj.cat ]]</td>
          <td>
              <label ng-repeat="w in cat_obj.words">[[ w ]]</label>
          </td>
            <td>
                <label>Comments</label>
            </td>
    </tr>
    <tr class="cascading-table-row" obj="details"></tr>

  </tbody>
</table>




<div>[[ details.user ]]</div>
<div>[[ details.date ]]</div>
<div>[[ details.teaAge ]]</div>
<div>[[ details.score_list ]]</div>
{#<div>[[ details.score_list_decimal | number]]</div>#}
<label ng-repeat="n in details.score_list_decimal">[[n | number:4]] , </label>





<div ng-repeat="(i, obj) in details.surveyData">
    <h4>Form [[ i +1]]</h4>

    <div ng-repeat="(k, v) in obj" class="card card-body bg-white">
        <h5>[[ k ]]</h5>
        <div ng-if="v.values">
            <label ng-repeat="s in v.values">[[s.value]]， </label>
            <div>[[ v.comments ]]</div>
        </div>
        <div ng-if="!v.values">
            <div ng-repeat="(sub, it) in v">
                <h6> - [[ sub ]] - </h6>
                <label ng-repeat="s in it.values">[[s.value]]， </label>
{#                <div>[[ it.values ]]</div>#}
                <div>[[ it.comments ]]</div>
            </div>

        </div>


    </div>
</div>




<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>


<script src="https://cdn.staticfile.org/angular.js/1.6.3/angular.min.js"></script>

<script>
    var app = angular.module('myApp', []);

    app.config(function($interpolateProvider){
        $interpolateProvider.startSymbol('[[').endSymbol(']]');
    });

    app.directive("cascadingTableRow", function() {
        //var test_val = "from derictive"
        return {
              scope: {
                 obj: '@'
              },
            template : "<td>dddddgf</td>  <td>hhhh</td>"
        };
    });

    app.controller('bodyController', function($scope, $http) {
        var user = document.getElementById('user').value
        var date = document.getElementById('date').value

        console.log(user, date)

        {#var url = "http://localhost:5000/service/survey/show?user="+ user + "&date=" + date#}
        var url = location.href.split('?')[0] + "/../../service/survey/show?user="+ user + "&date=" + date
        $http({
            method: 'GET',
            url: url
        }).then(function successCallback(response) {
                $scope.details = response.data
                console.log($scope.details)
            }, function errorCallback(response) {
                // 请求失败执行代码
        });

        $scope.round3 = function(num){
            return num.toFixed(3)
        }

    })
</script>

</body>
</html>